webpackJsonp([8],{614:function(e,t,n){"use strict";var r=n(2)["default"];Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),a=r(o),i=n(14),s=n(90),l=n(3),u=r(l),c=n(13),d=n(74),f=r(d),p=n(31),h=r(p),m=n(61),v=r(m),b=n(203),g=r(b),y=n(123),w=r(y),x=n(91),k=r(x);n(570),f["default"].addValidationRule("isLessThan",function(e,t,n){if(t&&e[n]){var r=parseFloat(t.replace(/:/g,".")),o=parseFloat(e[n].replace(/:/g,"."));return o>r}return!0}),f["default"].addValidationRule("isMoreThan",function(e,t,n){if(t&&e[n]){var r=parseFloat(e[n].replace(/:/g,".")),o=parseFloat(t.replace(/:/g,"."));return o>r}return!0});var E=a["default"].createClass({displayName:"AddClass",componentWillMount:function(){s.setActiveClass()},render:function(){var e=_.get(this.props,"classProfile.classProfile")||{},t=e.date?u["default"](e.date,"YYYYMMDD").format("YYYY-MM-DD"):null,n=_.get(this.props,"view.awaitingSave");return a["default"].createElement(c.Grid,{fluid:!0},a["default"].createElement("div",{className:"row header"},a["default"].createElement(c.Col,{xs:12},a["default"].createElement("h1",null,e._id?"Update Class":"Add Class"))),a["default"].createElement(c.Row,null,a["default"].createElement("div",{className:"col-xs-12 col-lg-10"},a["default"].createElement(c.Row,null,a["default"].createElement(f["default"].Form,{onValidSubmit:this.submitClass,onValid:this.enableButton,onInvalid:this.disableButton,className:"col-xs-12"},a["default"].createElement(c.Row,null,a["default"].createElement(v["default"],{className:"col-xs-12 ",type:"text",name:"name",title:"Class Name",value:e.name?e.name:"",validations:"isExisty",validationError:"Please enter a class name!",required:!0})),a["default"].createElement(c.Row,null,a["default"].createElement(g["default"],{className:"col-xs-12 ",type:"textarea",name:"description",value:e.description?e.description:"",title:"Class Description"})),a["default"].createElement(c.Row,null,a["default"].createElement(w["default"],{className:"col-xs-12 ",value:e.instructor?e.instructor.id:"",name:"instructor",title:"Instructor",options:this.getInstructors()})),a["default"].createElement(c.Row,null,a["default"].createElement(v["default"],{className:"col-xs-12 ",value:t?t:"",type:"date",name:"date",title:"Date",required:!0})),a["default"].createElement(c.Row,null,a["default"].createElement(v["default"],{className:"col-xs-12 col-sm-6 ",type:"time",name:"start",title:"Start Time",value:e.time?e.time.start:"",validations:"isLessThan:end",validationError:"Your start time is after your closing time!",required:!0}),a["default"].createElement(v["default"],{className:"col-xs-12 col-sm-6 ",type:"time",name:"end",title:"End Time",value:e.time?e.time.end:"",validations:"isMoreThan:start",validationError:"Your end time is before your opening time!",required:!0})),a["default"].createElement(c.Row,null,a["default"].createElement(v["default"],{className:"col-xs-12 col-sm-6 ",type:"text",name:"price",title:"Price",value:e.price?(e.price/100).toFixed(2):"",required:!0,validations:{isNumeric:!0},validationError:"Please enter a number!"}),a["default"].createElement(v["default"],{className:"col-xs-12 col-sm-6 ",type:"text",name:"capactiy",title:"Capacity",value:e.capacity?e.capacity:"",validations:{isInt:!0},validationError:"Please enter a number!",required:!0})),a["default"].createElement(c.Row,null,a["default"].createElement(c.Col,{xs:12},a["default"].createElement(c.Button,{type:"submit",value:"Submit",disabled:!this.state.canSubmit},n?a["default"].createElement(h["default"],{className:"button-spinner"}):e._id?"Update":"Submit"))))),a["default"].createElement(k["default"],{delay:5e3,response:this.props.view.response?this.props.view.response:null}))))},componentDidMount:function(){s.clearResponse()},getInitialState:function(){return{canSubmit:!1}},getInstructors:function(){return{data:_.map(_.get(this.props.instructors,"allInstructors",[]),function(e){return{name:e.name.first+" "+e.name.last,id:e._id}})}},submitClass:function(e){var t=u["default"](e.date).set("hour",e.start.split(":")[0]).set("minute",e.start.split(":")[1]).format(),n=u["default"]().isBefore(u["default"](t)),r=this.currency(e.price),o=r>0&&200>r?!1:!0;n&&o?(e.dateAndTime=t,e.date=u["default"](e.date).format("YYYYMMDD"),e["private"]=!1,e.price=r,e.name=e.name?e.name.trim():"",e.capacity=Number(e.capactiy),_.get(this.props,"classProfile.classProfile._id")?(e.SessionId=this.props.classProfile.classProfile._id,s.updateClass(e,this.props.classProfile.classProfile._id)):s.addClass(e)):o?s.setError({success:!1,message:"Invalid Date!"}):s.setError({success:!1,message:"Session price must be atleast $2.00"})},enableButton:function(){this.setState({canSubmit:!0})},disableButton:function(){this.setState({canSubmit:!1})},currency:function(e){var t=Number(e);return t=t.toFixed(2),100*t}});t["default"]=i.branch(E,{cursors:{view:["views","AddClass"]},facets:{instructors:"Instructors",classProfile:"ClassProfile"}}),e.exports=t["default"]}});